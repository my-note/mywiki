![](http://placekitten.com/1200/300)

## 1. 相关命令

* 查看磁盘的情况

    * df -Th

* 查看当前目录下每个目录的占用情况(不指定目录，默认为当前目录)

    * du -h --max-depth=1

* 查看当前目录的占用情况(不指定目录，默认为当前目录)

    * du -sh

```bash
-h: 以人类可读的方式
-s: 只显示一个总大小
--max-depth: 递归层级，只显示当前目录下一层
```

* 查看当前目录下，每个文件的大小

    * du -sh *

* 排序

    * `du -h --max-depth=1 /tmp | sort -n -k1`
    * -n, 通过数值大小规则排序; -nr, 通过数字大小反向排序(r 参数，反向排序)
    * -k1, 通过第一列的值排序


## 2. Q&A

1. **磁盘空间显示已近被占满，但是在查看磁盘的具体文件占用情况时，发现磁盘仍然有很大的空余空间**

    1. 执行df命令查看磁盘使用情况，发现磁盘已近满了
    2. 使用du命令查看各个目录的磁盘占用情况，把各个目录文件的大小相加，发现并没有占满磁盘，有10+G空间莫名失踪
    3. 为什么会出现这个情况？
        - 因为虽然文件已近被删除，但一些进程仍然打开这些文件，因此其占用的磁盘空间并没有被释放.
        - 将有问题的进程重启或者清空，磁盘就会得到释放


    > :books: 一个文件被删除了，但是还被其他进程引用? 
    > * df: 会统计这个已经被"删除"文件到已使用空间
    > * du: 不统计已"删除"被引用文件










